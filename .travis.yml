os: linux

dist: xenial

git:
  depth: 1

language: node_js

node_js:
  - 13.12.0 # Use Find and Replace to change

cache: npm

notifications:
  email: false

branches:
  only:
    - master
    - /^([0-9]|[1-9][0-9]*)\.([0-9]|[1-9][0-9]*)\.([0-9]|[1-9][0-9]*)(?:-([0-9A-Za-z-]+(?:\.[0-9A-Za-z-]+)*))?(?:\+[0-9A-Za-z-]+)?$/ # Semver, for pushed tags

jobs:
  include:
    - stage: Check
      script: npm run check:lint
      name: Lint

    - script: npm run check:typescript
      name: TypeScript

    - script: npm run check:coverage
      name: Test and coverage

    - script: npm run check:npm-audit
      name: npm audit

    - script: npm run check:depcheck
      name: npm run check:depcheck

    - stage: Deploy
      os: osx
      script: "# Deploying..."
      deploy:
        provider: releases
        token:
          secure: GFahoZ3jxPd4DN+gqf5gMxGDuxC3PeOKzf2eUTc96jEA+crnhImA2f8p8yL/6hacJsFnzu/1ElMyFN+U2JLLXPlFWJzHyvtepIH4uMD8qNVRF3C4ozgREhoFri9NfShqnCgIEu7Ryj7np/FioYof+k5twuD7fVZ8pdPRi6Q2QRZf5jqv0JG3iS3I5XZXbnUImJHInHMKcTgXOGnQQcAL4acrmO6zU0Eckdgw224swizl86CZFadjYwQPX2v6F22JPZo40cYt+GdqBewp7l7j412qcLN4BkN3XaLNDeoihPuTjtGqwL3CrX3X1chPkhyxLGcDXudJgvUG3AN9xsuhG/XAHSkEEkiBqLK4NUsmuPIntJKQ0oQ0qU2+KAE6DF5xlOUPCD/8ab470jbdB4z0WS9/zKT3HbqvC9hY0GM8kS4A0haX1zoQN5KJmcf3P0Yk8kyr61o9xOsVbuYzx9o6Me34jL2jWgQhRlcqoRAXJq2c679KRUHi0PYZTLPYKCEtIJ+2+MEcovTcUxdQyY5cDdQRW8F6+eSd3LrJlioP+DIilJnIujF+wORn0g2WyFKX2HzYXvsnLMQctk/XU4RG07HWgAw0Q0Vx9G+dkeqlXkhWBHHBALjVho+wTP5PWdkqzVWCurP/bU8uJ7jQndntXmzjPdgZ2S96AR0XDg/8NVo=
        file: artifacts/electronPackager/Orange (macOS).zip # Use Find and Replace to change
        draft: true
        on:
          tags: true
        edge: true

      before_deploy: npm run create-package
